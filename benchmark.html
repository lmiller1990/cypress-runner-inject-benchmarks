<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title></title>
  </head>
  <body>
    <script>
      function inject(src) {
        return new Promise(resolve => {
          const id = (Math.random()).toFixed(10)
          s = document.createElement('script')
          s.src = src
          s.id = 'my-script'
          let start
          s.onload = () => {
            let end = performance.now()
            resolve(end - start)
          }
          document.getElementById('my-script')?.remove()
          start = performance.now()
          document.head.appendChild(s)
        })
      }

      const injectMs = []

      async function main () {
        for (let i = 0; i < 100; i++) {
          let time = await inject('cypress_runner.js')
          console.log(`Time to inject & parse: ${time}ms`)
          injectMs.push(time)
        }
    
        const sum = injectMs.reduce((acc, curr) => acc + curr, 0)
        console.log(`\n--- Average time: ${sum / injectMs.length} ---`)
      }

      main()
    </script>
  </body>
</html>
